{"name":"zl-fetch-factory","version":"0.3.1","description":"Fetch-factory's copy","main":"lib/index.js","scripts":{"example":"open http://localhost:8000/example && python -m SimpleHTTPServer","browserify":"mkdir -p dist && browserify lib/browserify-entry.js -o dist/fetch-factory.js -s fetchFactory","minify":"uglifyjs dist/fetch-factory.js > dist/fetch-factory.min.js","build":"npm run babel && npm run browserify && npm run minify","babel":"babel -d lib src","prepublish":"npm run build","pretest":"eslint src spec","test":"babel-tape-runner spec/*.spec.js"},"repository":"https://github.com/zhulux/fetch-factory","license":"ISC","dependencies":{"es6-promise":"^3.0.2","fetch-everywhere":"^1.0.5","isomorphic-fetch":"^2.1.1","lodash.assign":"^3.2.0","lodash.get":"^3.7.0","lodash.isempty":"^3.0.4","lodash.merge":"^3.3.2","lodash.pick":"^3.1.0","nock":"^2.18.0","query-string":"^2.4.1","url-pattern":"^0.10.0"},"devDependencies":{"babel-cli":"^6.1.2","babel-core":"^6.1.2","babel-eslint":"^4.1.6","babel-preset-es2015":"^6.1.2","babel-tape-runner":"^1.3.0","browserify":"^12.0.1","eslint":"^1.10.3","sinon":"^1.16.1","tape":"^4.2.0","uglify-js":"^2.5.0"},"gitHead":"c39d3b2cfcea5b61622f5fad59f1d3333a90f5e2","homepage":"https://github.com/zhulux/fetch-factory#readme","versions":[{"number":"0.1.0","date":"2016-07-07T15:00:29.126Z"},{"number":"0.1.1","date":"2016-07-07T15:43:26.996Z"},{"number":"0.1.2","date":"2016-07-07T15:49:21.586Z"},{"number":"0.1.3","date":"2016-07-07T16:39:55.759Z"},{"number":"0.1.4","date":"2016-07-07T16:57:30.232Z"},{"number":"0.1.6","date":"2016-07-08T18:08:37.238Z"},{"number":"0.1.7","date":"2016-07-08T18:21:20.741Z"},{"number":"0.1.8","date":"2016-07-08T21:05:34.338Z"},{"number":"0.1.9","date":"2016-07-10T15:34:20.518Z"},{"number":"0.2.0","date":"2016-07-10T15:44:54.702Z"},{"number":"0.2.1","date":"2016-07-12T07:00:00.695Z"},{"number":"0.3.1","date":"2017-03-30T10:52:51.738Z"}],"readme":"# fetch-factory\n\nA wrapper around the new `fetch` API to make creating services to talk to APIs easier.\n\n##Â Example\n\n```js\nvar fetchFactory = require('fetch-factory');\n\nvar Users = fetchFactory.create({\n    url: 'http://api.mysite.com/users/:id',\n}, {\n    find: { method: 'GET' },\n    create: { method: 'POST' },\n});\n\nUsers.find(); // GET /users\n\nUsers.find({\n    params: { id: 123 },\n}); // GET /users/123\n\nUsers.create({\n    data: {\n        name: 'Jack',\n    },\n}); // POST /users with JSON stringified obj { name: 'jack' }\n```\n\nYou can run another example by cloning this repo and running `npm i && npm run example`.\n\n## Install\n\n```\nnpm install fetch-factory\n```\n\nConsumable in the client through jspm, Webpack or Browserify.\n\nYou can also grab `dist/fetch-factory.js` or `dist/fetch-factory.min.js` which is a browser build. It exposes `global.fetchFactory`. `example/index.html` shows how you would use this.\n\nNote that this library assumes a global `fetch` and `Promise` object. If you need to polyfill these, the following are recommended:\n\n- [github/fetch](https://github.com/github/fetch) `window.fetch` polyfill\n- [jakearchibald/es6-promise](https://github.com/jakearchibald/es6-promise) `Promise` polyfill.\n\n## Configuration\n\nConfiguration for a particular request can be set in one of three places:\n\n- in the config object that's the first argument to `fetchFactory.create`\n- in an object that you pass when telling fetch-factory what methods to create\n- in the call to the method that fetch factory created\n\nConfiguration set further down the chain will override configuration set previously. For example:\n\n```js\nvar UserFactory = fetchFactory.create({\n    url: 'http://api.mysite.com/users/:id',\n    method: 'GET',\n}, {\n    find: {},\n    create: { method: 'POST' },\n});\n```\n\nWhen `UserFactory.find` is called, it will make a `GET` request, because the default configuration for `UserFactory` was given `method: 'GET'`. However, when `UserFactory.create` is called, it will make a `POST` request, because configuration was passed that is specific to that method. Although in reality you never need to, you could call `UserFactory.find({ method: 'POST' })`, which would cause the `find` method to make a `POST` request that time, because configuration passed in when a method is invoked overrides any set before it.\n\n## POST Requests\n\nWhen a method defined by fetch-factory makes a `POST` request, it assumes that you'd like to POST JSON and sets some extra configuration:\n- the `Accept` header of the request is set to `application/json`\n- the `Content-Type` header of the request is set to `application/json`\n- if you pass in a `data` parameter, that is converted into JSON and sent as the body of the request\n\n## Shortcut Methods\n\nThere's a few methods that we've come to use often with our factories: `find`, `create` and `update`. fetch-factory comes with these definitions by default, so you can just tell it which ones you'd like to create:\n\n```js\nvar UserFactory = fetchFactory.create({\n    url: '/users/:id',\n    methods: ['find', 'create'],\n});\n```\n\n## Interceptors\n\nfetch-factory also supports the concept of interceptors that can take a request and manipulate it before passing it on.\n\n### Request Interceptors\n\nIf you need to apply a transformation to every request before it is made (for example, adding an authorisation header), you can use a request interceptor. These can be sync or async. You can define a single request interceptor, or an array of multiple. An interceptor is expected to return the modified request object, or a new object with three properties:\n\n- `headers`: an object of key value pairs mapping headers to values\n- `body`: the string representing the request body, or `null`.\n- `method`: the method of the request\n\n```js\nvar UserFactory = fetchFactory.create({\n    url: 'http://api.mysite.com/users/:id',\n    method: 'GET',\n    interceptors: {\n        request: function(request) {\n            request.headers['Authorisation']: 'Bearer ACCESS_TOKEN123';\n            return request;\n        },\n    },\n}, {\n    find: {},\n});\n\nUserFactory.find().then(function(data) {\n    console.log(data.name) // 'bob'\n});\n```\n\nBy using an interceptor in this way you can avoid repeating the authorisation logic accross your frontend code base.\n\n### Response Interceptors\n\nBy default, fetch-factory will call its two default response interceptors:\n1) Simply checks the status and rejects on any non-2xx status\n2) Simply takes the stream returned by `fetch` and consumes it as JSON, returning a JavaScript object.\n\nYou can override these default interceptors by passing an `interceptors` object with a `response` key:\n\n```js\nvar UserFactory = fetchFactory.create({\n    url: 'http://api.mysite.com/users/:id',\n    method: 'GET',\n    interceptors: {\n        response: function(data) {\n            return { name: 'bob' };\n        },\n    },\n}, {\n    find: {},\n});\n\nUserFactory.find().then(function(data) {\n    console.log(data.name) // 'bob'\n});\n```\n\nA time when you might want to override the default response interceptor is if you need access to extra information on the response, such as headers. In this case fetch-factory's default interceptor will be insufficient, and you should override it to simply pass the full request through:\n\n```js\nvar UserFactory = fetchFactory.create({\n    url: 'http://api.mysite.com/users/:id',\n    method: 'GET',\n    interceptors: {\n        response: function(response) { return response; },\n    },\n}, {\n    find: {},\n});\n\nUserFactory.find().then(function(response) {\n    console.log(response.headers.get('Content-Type'));\n});\n```\n\n\n\n## Changelog\n\n##### V0.2.1 - 8/12/2015\n- fix issue that lead to port numbers in URLs not working - thanks @copyhold\n\n##### V0.2.0 - 8/12/2015\n- fix isssue that lead to being unable to create more than one factory\n\n##### V0.1.0 - 11/11/2015\n- first release\n","created":"2016-07-07T15:00:29.126Z","modified":"2017-03-30T10:52:51.738Z","lastPublisher":{"name":"moejser","email":"444984@qq.com"},"owners":[{"name":"moejser","email":"444984@qq.com"}],"other":{"_attachments":{},"_from":".","_id":"zl-fetch-factory","_nodeVersion":"7.6.0","_npmOperationalInternal":{"host":"packages-18-east.internal.npmjs.com","tmp":"tmp/zl-fetch-factory-0.3.1.tgz_1490871169557_0.5266798520460725"},"_npmUser":{"name":"moejser","email":"444984@qq.com"},"_npmVersion":"4.1.2","_rev":"2-3b76f6b9ab8961e81ae160d8025396dc","_shasum":"b32c104ed4e62aaa721d4d888b17c5b71cb6cc51","author":"","bugs":{"url":"https://github.com/zhulux/fetch-factory/issues"},"directories":{},"dist-tags":{"latest":"0.3.1"},"dist":{"shasum":"b32c104ed4e62aaa721d4d888b17c5b71cb6cc51","tarball":"https://registry.npmjs.org/zl-fetch-factory/-/zl-fetch-factory-0.3.1.tgz"},"maintainers":[{"name":"moejser","email":"444984@qq.com"}],"readmeFilename":"README.md","time":{"modified":"2017-03-30T10:52:51.738Z","created":"2016-07-07T15:00:29.126Z","0.1.0":"2016-07-07T15:00:29.126Z","0.1.1":"2016-07-07T15:43:26.996Z","0.1.2":"2016-07-07T15:49:21.586Z","0.1.3":"2016-07-07T16:39:55.759Z","0.1.4":"2016-07-07T16:57:30.232Z","0.1.6":"2016-07-08T18:08:37.238Z","0.1.7":"2016-07-08T18:21:20.741Z","0.1.8":"2016-07-08T21:05:34.338Z","0.1.9":"2016-07-10T15:34:20.518Z","0.2.0":"2016-07-10T15:44:54.702Z","0.2.1":"2016-07-12T07:00:00.695Z","0.3.1":"2017-03-30T10:52:51.738Z"}}}